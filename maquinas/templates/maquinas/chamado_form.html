{% extends "maquinas/base.html" %}
{% load crispy_forms_tags %} {# Ou remova se não usar crispy #}

{% block pagina_titulo %}{{ titulo_formulario|default:"Gerenciar Chamado" }}{% endblock %}

{% block conteudo %}
<h3>{{ titulo_formulario }}</h3>
<hr>
<p><strong>Máquina:</strong> {{ chamado.maquina_fisica.nome_patrimonio }} (Planta: {{ chamado.maquina_fisica.planta_layout.nome|default:"N/A" }})</p>
<p><strong>Reportado por:</strong> {{ chamado.usuario_reportou.username|default:"Sistema" }} em {{ chamado.data_abertura|date:"d/m/Y H:i" }}</p>
<hr>

<form method="post" id="chamado-form"> {# enctype não é necessário se não houver upload de arquivo #}
    {% csrf_token %}

    {# Se usar crispy-forms: #}
    {# {{ form|crispy }} #}

    {# Se NÃO usar crispy-forms: #}
    {{ form.as_p }}

    <div style="margin-top: 20px;">
        <button type="submit" id="submit-button-chamado" class="btn-salvar" style="padding: 8px 15px; background-color: #28a745; color: white; border: none; border-radius: 4px; cursor:pointer;">
            Salvar Alterações
        </button>
        <a href="{% url 'maquinas:chamado_list' %}" style="margin-left: 10px; color: #6c757d; text-decoration:none;">Cancelar</a>
    </div>
</form>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('chamado-form');
    const submitButton = document.getElementById('submit-button-chamado');

    if (form && submitButton) {
        form.addEventListener('submit', function() {
            submitButton.disabled = true;
            submitButton.textContent = 'Salvando...';
        });
    }
});
</script>
{% endblock %}